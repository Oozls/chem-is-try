{% extends "base.html" %}

{% block content %}
<div class="detail-container">
    <div class="compact-header">
        <div class="title-row">
            <h2>{{ reagent.name }}</h2>
            {% if reagent.category %}
            <span class="badge category">{{ reagent.category }}</span>
            {% endif %}
            {% if reagent.misc == 'ë…ê·¹ë¬¼' %}
                <span class="badge danger">ë…ê·¹ë¬¼</span>
            {% endif %}
        </div>
        <!-- <div class="meta-info">
            <span>ID: {{ reagent._id }}</span>
        </div> -->
    </div>

    <div class="summary-bar">
        <div class="summary-item">
            <span class="label">ìœ„ì¹˜</span>
            <span class="value">{{ reagent.location }}ë²ˆ ì‹œì•½ì¥</span>
        </div>
        <div class="divider"></div>
        <div class="summary-item">
            <span class="label">ìˆ˜ëŸ‰</span>
            <span class="value">{{ reagent.amount }}</span>
        </div>
        <div class="divider"></div>
        <div class="summary-item">
            <span class="label">ì”ëŸ‰</span>
            <span class="value highlight">{{ reagent.left_amount }}</span>
        </div>
        <div class="divider"></div>
        <div class="summary-item">
            <span class="label">ë¹„ê³ </span>
            <span class="value">{{ reagent.misc if reagent.misc else '-' }}</span>
        </div>
        <div class="divider"></div>
        <div class="summary-item" style="max-width: 200px; overflow: auto;">
            <span class="label">Cas No.</span>
            <span class="value" style="letter-spacing: -1px;">
                {% if cas_info.status == 'success' %}
                    {{ cas_info.cas if cas_info.cas else cas_info.message }}
                {% else %}
                -
                {% endif %}
            </span>
        </div>
    </div>

    <div class="custom-content-area">
        <h3>ğŸ“‹ ìƒì„¸ ì •ë³´ &#40;GHS ê²½ê³ í‘œì§€&#41;</h3>
        {% if ghs_info %}
        <div class="custom-body">
            <div>
                {% if ghs_info.pictograms %}
                    {% for img in ghs_info.pictograms %}
                        <img src="{{ img }}" style="width: 5rem;" alt="">
                    {% endfor %}
                {% endif %}
            </div>

            {% if ghs_info.hazard_statements %}
                {% for msg in ghs_info.hazard_statements %}
                    <br><span>{{ msg }}</span>
                {% endfor %}
            {% endif %}

            {% if ghs_info.message == "GHS info not found." %}
                <p style="color: #888;">ë“±ë¡ëœ ì¶”ê°€ ìƒì„¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
            {% endif %}

            {% if reagent['cid'] != "" and reagent['cid'] %}
                <br><br><a href="https://pubchem.ncbi.nlm.nih.gov/compound/{{ reagent.cid }}" class="pubchem-link" target="_blank", style="font-weight: 700;">ë¯¸êµ­ êµ­ë¦½ ì˜í•™ ë„ì„œê´€ PubChem â†µ</a>
            {% endif %}
        </div>
        {% else %}
        <span>CID ì •ë³´ê°€ ë“±ë¡ë˜ì§€ ì•Šì•„ ê²½ê³ í‘œì§€ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>
        {% endif %}
    </div>

    <div class="form-actions" style="margin-top: 30px; justify-content: flex-end;">
        <a href="/reagent" class="btn-secondary" style="text-decoration: none;">ëª©ë¡</a>
        
        {% if current_user.is_authenticated and current_user.is_admin() %}
            <a href="/reagent/edit/{{ reagent._id }}" class="btn-primary" style="text-decoration: none;">ìˆ˜ì •</a>
            <a href="/reagent/delete/{{ reagent._id }}" class="btn-danger" style="text-decoration: none;">ì‚­ì œ</a>
        {% endif %}
    </div>
</div>
{% endblock %}